from enum import Enum

from pydantic import BaseModel


class Exploit(BaseModel):
    exploit_id: int

    task_id: int
    user_id: int
    exploit_text: str


class ExploitResult(str, Enum):
    ok = "OK"
    no_flags = "NO FLAGS"
    machine_start_timeout = "MACHINE START TIMEOUT"
    other_checker_fail = "OTHER CHECKER FAIL"
    error = "ERROR"


class ExploitStatus(str, Enum):
    starting = "starting"
    waiting_for_machine = "waiting for machine"
    sending_flags = "sending flags"
    running = "running"
    to_delete_machine = "to delete machine"
    checked = "checked"


class ExploitRun(BaseModel):
    run_id: int
    exploit_id: int
    target_image: str
    status: ExploitStatus | None
    result: ExploitResult | None
